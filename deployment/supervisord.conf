[supervisord]
nodaemon=true
logfile=/dev/null
pidfile=/var/run/supervisord.pid

[program:rag]
command=/opt/rag-venv/bin/python -m src.service
directory=/app/dailydrip_rag
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=RAG_PERSIST_DIR="/app/indexes/chroma"

[program:agent]
command=/opt/agent-venv/bin/uvicorn agent_core.agent:app --host 0.0.0.0 --port 9000
directory=/app
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
# Ensure agent knows where RAG is
environment=RAG_SERVICE_URL="http://localhost:8000"

[program:nginx]
command=nginx -g 'daemon off;'
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
